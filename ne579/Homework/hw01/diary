x = zeros(20, 4)

x =

     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0
     0     0     0     0

means = randi(100, 4, 1)

means =

    61
    27
    66
    69

stds = randi(100, 4, 1)

stds =

    75
    46
     9
    23

for i = 1:length(means)
x(:, i) = randn(length(x(:, i)), 1) * stds(i) + means(i);
end
x

x =

  162.5946  -45.5446   65.6871   35.6708
  -19.4116   50.3668   58.8165   76.6707
  133.0715   39.9713   75.1682   78.0011
   70.3037   28.5401   64.8010   79.3886
  168.7522  -34.3492   59.5692   66.0035
  -86.0675   78.8646   78.1625   73.2248
   46.1726   43.1083   63.9771   58.0485
  -29.5884   13.2430   60.6987   88.8265
  279.1006   28.0529   63.3562   37.6810
  122.8914   14.9482   58.3687   79.4657
  164.4229  -53.5098   55.9188   49.4797
  -18.3635   13.8601   88.7340   61.2976
   25.8538  -11.2429   80.8995   81.7140
   40.5648  -18.0435   68.7678   92.8991
  143.3818  -26.1945   54.6859   43.2943
   40.1596    2.4564   58.2108   97.9952
  113.6156  -65.1212   64.4112   84.1833
  -92.8862   71.3546   73.1227   67.4391
   34.4613   50.9228   54.0120   64.5099
   -0.7690   26.0787   45.0312   63.9951

[xs, x_mean, x_std] = zscore1(x)

xs =

    1.0277   -1.3605    0.1025   -1.8841
   -0.8871    0.9724   -0.5574    0.4344
    0.7171    0.7196    1.0132    0.5096
    0.0567    0.4415    0.0174    0.5881
    1.0924   -1.0882   -0.4851   -0.1689
   -1.5884    1.6656    1.3008    0.2395
   -0.1972    0.7959   -0.0618   -0.6187
   -0.9942    0.0694   -0.3767    1.1218
    2.2534    0.4297   -0.1214   -1.7704
    0.6100    0.1109   -0.6005    0.5924
    1.0469   -1.5542   -0.8358   -1.1032
   -0.8761    0.0845    2.3163   -0.4350
   -0.4109   -0.5261    1.5637    0.7196
   -0.2562   -0.6916    0.3984    1.3521
    0.8255   -0.8898   -0.9542   -1.4530
   -0.2604   -0.1929   -0.6156    1.6402
    0.5124   -1.8367   -0.0201    0.8592
   -1.6601    1.4829    0.8167   -0.0877
   -0.3204    0.9860   -1.0190   -0.2533
   -0.6910    0.3817   -1.8816   -0.2824


x_mean =

   64.9130   10.3881   64.6200   68.9894


x_std =

   95.0523   41.1120   10.4107   17.6840

mean(xs(:,1))

ans =

   8.8818e-17

mean(xs(:,2))

ans =

  -1.9429e-17

mean(xs(:,3))

ans =

  -6.1062e-16

mean(xs(:,4))

ans =

   4.9960e-16

% The means are very close to zero

std(xs(:,1))

ans =

     1

std(xs(:,2))

ans =

     1

std(xs(:,3))

ans =

     1

std(xs(:,4))

ans =

    1.0000

% Standard deviations are at unity
% Means and standard deviations depart from the true values, possibly because of small sample size (20 rows)
% To test, see if larger set (say, 2000 rows) get closer means and standard deviations
y = zeros(2000, 4);
for i = 1:length(means)
y(:, i) = randn(length(y(:, i)), 1) * stds(i) + means(i);
end
[ys, y_mean, y_std] = zscore1(y);
y_mean

y_mean =

   61.9135   28.1843   65.8792   68.7288

means

means =

    61
    27
    66
    69

y_std

y_std =

   74.2331   45.7745    8.9597   22.7181

stds

stds =

    75
    46
     9
    23

% Sure enough, these are much closer to the true values
diary off
